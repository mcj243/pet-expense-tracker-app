<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pawsitive Pet Tracker</title>
  <!-- Tailwind CSS CDN -->
  <script/cdn.tailwindcss.com</script>
  <!-- Phosphor Icons -->
  <script src="https://unpkg.com/@phosphor-iconscript>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet--color-bg-deep: #181818;
      --color-card-dark: #292929;
      --color-primary-accent: #00bcd4;
      --color-secondary-accent: #ffeb3b;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--color-bg-deep);
      min-height: 100vh;
      padding: 20px;
    }

    .tracker-container {
      width: 100%;
      max-width: 1000px;
      margin: 30px auto;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
      background-color: var(--color-card-dark);
      border-radius: 1.5rem;
      overflow: hidden;
      border: 1px solid #3d3d3d;
    }

    header {
      background-color: #111111;
    }

    .header-title {
      color: white;
    }

    .tab-button {
      transition: all 0.2s;
      border-radius: 0.5rem 0.5rem 0 0;
      margin: 0 4px;
      color: #b0b0b0;
      background-color: var(--color-card-dark);
    }

    .tab-button.active {
      background-color: var(--color-bg-deep);
      color: white;
      border-bottom: 4px solid var(--color-primary-accent);
      font-weight: 700;
    }

    .tab-content {
      background-color: var(--color-bg-deep);
    }

    .pill-category {
      background-color: #3d3d3d;
      color: var(--color-secondary-accent);
      padding: 4px 10px;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
      border: 1px solid #4d4d4d;
    }
  </style>
</head>
<body>
  <div id="app" class="tracker-container">
    <!-- Header -->
    <header class="p-6 flex flex-col md:flex-row justify-between items-center">
      <h1 class="text-3xl font-extrabold header-title flex items-center mb-4 md:mb-0">
        <i class="ph-paw-print-fill text-4xl mr-3" style="color: var(--color-primary-accent);"></i>
        Pawsitive Tracker
      </h1>
      <div id="user-info" class="text-sm text-gray-400 bg-gray-700 p-2 rounded-lg">
        Status: Ready (Local Storage)
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="flex border-b border-gray-700 p-2">
      <button data-tab="dashboard" class="tab-button flex-1 py-3 px-4 text-sm hover:bg-gray-800 active">
        <i class="ph-gauge text-xl mr-2"></i>Dashboard
      </button>
      <button data-tab="expenses" class="tab-button flex-1 py-3 px-4 text-sm hover:bg-gray-800">
        <i class="ph-currency-circle-dollar text-xl mr-2"></i>Expenses
      </button>
      <button data-tab="health" class="tab-button flex-1 py-3 px-4 text-sm hover:bg-gray-800">
        <i class="ph-heartbeat text-xl mr-2"></i>Health Log
      </button>
      <button data-tab="guide" class="tab-button flex-1 py-3 px-4 text-sm hover:bg-gray-800">
        <i class="ph-question text-xl mr-2"></i>Quick Guide
      </button>
    </nav>

    <!-- Dashboard -->
    <div id="dashboard" class="p-6 tab-content">
      <h2 class="text-2xl font-bold mb-6 text-white">Overall Pet Summary</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Card 1 -->
        <div class="bg-gray-800 p-5 rounded-xl border border-gray-700 shadow-xl">
          <div class="flex items-center">
            <i class="ph-wallet text-3xl mr-3" style="color: var(--color-secondary-accent);"></i>
            <h3 class="text-sm font-semibold text-gray-300">Total Yearly Spend</h3>
          </div>
          <p id="total-spend-display" class="text-4xl font-extrabold text-white mt-2">£0.00</p>
          <p class="text-xs text-gray-400 mt-1">Based on local browser records.</p>
        </div>
        <!-- Card 2 -->
        <div class="bg-gray-800 p-5 rounded-xl border border-gray-700 shadow-xl">
          <div class="flex items-center">
            <i class="ph-calendar-check text-3xl mr-3" style="color: var(--color-primary-accent);"></i>
            <h3 class="text-sm font-semibold text-gray-300">Next Health Event Due</h3>
          </div>
          <p id="next-appointment-display" class="text-2xl font-bold text-white mt-2">N/A</p>
          <p id="next-appointment-date" class="text-xs text-gray-400 mt-1">Check your Health Log.</p>
        </div>
        <!-- Card 3 -->
        <div class="bg-gray-800 p-5 rounded-xl border border-gray-700 shadow-xl">
          <div class="flex items-center">
            <i class="ph-chart-line text-3xl mr-3" style="color: var(--color-secondary-accent);"></i>
            <h3 class="text-sm font-semibold text-gray-300">Top Expense Category</h3>
          </div>
          <p id="top-category-display" class="text-2xl font-bold text-white mt-2">---</p>
          <p class="text-xs text-gray-400 mt-1">Where most of your money goes.</p>
        </div>
      </div>
    </div>

    <!-- Expenses -->
    <div id="expenses" class="p-6 tab-content hidden">
      <h2 class="text-2xl font-bold mb-4 text-white">Expense Log</h2>
      <div class="bg-gray-800 p-4 rounded-lg mb-6 shadow-lg">
        <h3 class="font-medium mb-3 text-gray-200">Add New Expense</h3>
        <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
          <input type="date" id="expense-date" class="p-2 border rounded-lg text-sm" required>
          <select id="expense-category" class="p-2 border rounded-lg text-sm" required>
            <option value="">Category</option>
            <option value="Food/Treats">Food/Treats</option>
            <option value="Vet Bills">Vet Bills</option>
            <option value="Grooming">Grooming</option>
            <option value="Supplies/Toys">Supplies/Toys</option>
            <option value="Insurance">Insurance</option>
            <option value="Other">Other</option>
          </select>
          <input type="number" id="expense-cost" class="p-2 border rounded-lg text-sm" placeholder="Cost (£)" step="0.01" required>
          <input type="text" id="expense-description" class="p-2 border rounded-lg text-sm col-span-2 md:col-span-1" placeholder="Description">
          <button onclick="addExpense()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-lg transition duration-200 col-span-2 md:col-span-1">
            <i class="ph-plus-circle text-xl mr-1"></i> Add Expense
          </button>
        </div>
        <p id="expense-error" class="text-red-400 text-sm mt-2 hidden"></p>
      </div>
      <div class="scroll-area shadow-inner">
        <table class="data-table min-w-full divide-y divide-gray-700">
          <thead>
            <tr>
              <th>Date</th><th>Category</th><th>Description</th><th>Cost (£)</th><th>Action</th>
            </tr>
          </thead>
          <tbody id="expense-table-body" class="bg-gray-800 divide-y divide-gray-700"></tbody>
        </table>
      </div>
      <p id="expense-empty-message" class="text-gray-400 text-center mt-4 hidden">No expenses recorded yet!</p>
    </div>

    <!-- Health -->
    <div id="health" class="p-6 tab-content hidden">
      <h2 class="text-2xl font-bold mb-4 text-white">Health and Appointment Log</h2>
      <div class="bg-gray-800 p-4 rounded-lg mb-6 shadow-lg">
        <h3 class="font-medium mb-3 text-gray-200">Add New Appointment / Treatment</h3>
        <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
          <input type="date" id="health-date" class="p-2 border rounded-lg text-sm" required>
          <select id="health-type" class="p-2 border rounded-lg text-sm" required>
            <option value="">Type</option>
            <option value="Vaccination">Vaccination</option>
            <option value="Flea/Tick Treatment">Flea/Tick Treatment</option>
            <option value="Worming">Worming</option>
            <option value="Annual Checkup">Annual Checkup</option>
            <option value="Medication">Medication</option>
            <option value="Other">Other</option>
          </select>
          <input type="date" id="health-next-due" class="p-2 border rounded-lg text-sm" placeholder="Next Due Date">
          <input type="text" id="health-notes" class="p-2 border rounded-lg text-sm col-span-2 md:col-span-1" placeholder="Notes">
          <button onclick="addHealthEntry()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-lg transition duration-200 col-span-2 md:col-span-1">
            <i class="ph-plus-circle text-xl mr-1"></i> Add Health Log
          </button>
        </div>
        <p id="health-error" class="text-red-400 text-sm mt-2 hidden"></p>
      </div>
      <div class="scroll-area shadow-inner">
        <table class="data-table min-w-full divide-y divide-gray-700">
          <thead>
            <tr>
              <th>Date</th><th>Type</th><th>Next Due</th><th>Notes</th><th>Action</th>
            </tr>
          </thead>
          <tbody id="health-table-body" class="bg-gray-800 divide-y divide-gray-700"></tbody>
        </table>
      </div>
      <p id="health-empty-message" class="text-gray-400 text-center mt-4 hidden">No health events recorded yet!</p>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    const EXPENSES_KEY = 'pawsitiveTrackerExpenses';
    const HEALTH_KEY = 'pawsitiveTrackerHealth';
    let expenses = [];
    let healthLog = [];

    const formatCurrency = amount => new Intl.NumberFormat('en-GB', { style: 'currency', currency: 'GBP' }).format(amount);
    const formatDate = dateString => dateString ? new Date(dateString).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }) : 'N/A';

    const loadData = () => {
      expenses = JSON.parse(localStorage.getItem(EXPENSES_KEY) || '[]');
      healthLog = JSON.parse(localStorage.getItem(HEALTH_KEY) || '[]');
    };

    const saveData = () => {
      localStorage.setItem(EXPENSES_KEY, JSON.stringify(expenses));
      localStorage.setItem(HEALTH_KEY, JSON.stringify(healthLog));
    };

    const refreshUI = () => {
      renderExpenses();
      renderHealthLog();
      updateDashboard();
    };

    const addExpense = () => {
      const date = document.getElementById('expense-date').value;
      const category = document.getElementById('expense-category').value;
      const cost = parseFloat(document.getElementById('expense-cost').value);
      const description = document.getElementById('expense-description').value.trim();
      const errorDisplay = document.getElementById('expense-error');

      if (!date || !category || isNaN(cost) || cost <= 0) {
        errorDisplay.textContent = 'Please fill in Date, Category, and a valid Cost.';
        errorDisplay.classList.remove('hidden');
        return;
      }
      errorDisplay.classList.add('hidden');

      expenses.push({ id: Date.now().toString(), date, category, cost: cost.toFixed(2), description: description || 'N/A' });
      saveData();
      document.getElementById('expense-date').value = '';
      document.getElementById('expense-category').value = '';
      document.getElementById('expense-cost').value = '';
      document.getElementById('expense-description').value = '';
      refreshUI();
    };

    const removeExpense = id => {
      expenses = expenses.filter(item => item.id !== id);
      saveData();
      refreshUI();
    };

    const renderExpenses = () => {
      const tbody = document.getElementById('expense-table-body');
      tbody.innerHTML = '';
      const sortedExpenses = [...expenses].sort((a, b) => new Date(b.date) - new Date(a.date));
      document.getElementById('expense-empty-message').classList.toggle('hidden', sortedExpenses.length > 0);
      sortedExpenses.forEach(item => {
        const row = tbody.insertRow();
        row.insertCell().textContent = formatDate(item.date);
        row.insertCell().innerHTML = `<span class="pill-category">${item.category}</span>`;
        row.insertCell().textContent = item.description;
        row.insertCell().textContent = formatCurrency(item.cost);
        row.insertCell().innerHTML = `<button onclick="removeExpense('${item.id}')" class="text-red-400 hover:text-red-200"><i class="ph-trash"></i></button>`;
      });
    };

    const addHealthEntry = () => {
      const date = document.getElementById('health-date').value;
      const type = document.getElementById('health-type').value;
      const nextDue = document.getElementById('health-next-due').value;
      const notes = document.getElementById('health-notes').value.trim();
      const errorDisplay = document.getElementById('health-error');

      if (!date || !type) {
        errorDisplay.textContent = 'Please fill in Date and Type.';
        errorDisplay.classList.remove('hidden');
        return;
      }
      errorDisplay.classList.add('hidden');

      healthLog.push({ id: Date.now().toString(), date, type, nextDue: nextDue || 'N/A', notes: notes || 'N/A' });
      saveData();
      document.getElementById('health-date').value = '';
      document.getElementById('health-type').value = '';
      document.getElementById('health-next-due').value = '';
      document.getElementById('health-notes').value = '';
      refreshUI();
    };

    const removeHealthEntry = id => {
      healthLog = healthLog.filter(item => item.id !== id);
      saveData();
      refreshUI();
    };

    const renderHealthLog = () => {
      const tbody = document.getElementById('health-table-body');
      tbody.innerHTML = '';
      const sortedHealth = [...healthLog].sort((a, b) => new Date(b.date) - new Date(a.date));
      document.getElementById('health-empty-message').classList.toggle('hidden', sortedHealth.length > 0);
      sortedHealth.forEach(item => {
        const row = tbody.insertRow();
        row.insertCell().textContent = formatDate(item.date);
        row.insertCell().innerHTML = `<span class="pill-category">${item.type}</span>`;
        row.insertCell().textContent = formatDate(item.nextDue);
        row.insertCell().textContent = item.notes;
        row.insertCell().innerHTML = `<button onclick="removeHealthEntry('${item.id}')" class="text-red-400 hover:text-red-200"><i class="ph-trash"></i></button>`;
      });
    };

    const updateDashboard = () => {
      const totalSpend = expenses.reduce((sum, item) => sum + parseFloat(item.cost || 0), 0);
      document.getElementById('total-spend-display').textContent = formatCurrency(totalSpend);

      const categoryMap = expenses.reduce((map, item) => {
        map[item.category] = (map[item.category] || 0) + parseFloat(item.cost || 0);
        return map;
      }, {});
      const topCategory = Object.entries(categoryMap).sort(([, a], [, b]) => b - a)[0]?.[0] || 'No Data';
      document.getElementById('top-category-display').textContent = topCategory;

      let nextAppointment = { date: 'N/A', days: Infinity, type: 'N/A' };
      healthLog.forEach(item => {
